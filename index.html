<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Controle Financeiro</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide-react/0.263.1/lucide-react.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' fill='%232563eb' viewBox='0 0 24 24'><path d='M12 2v20m0-20l-7 7h14l-7-7z'/></svg>">
    <style>
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading">
            <div class="text-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                <p class="text-gray-600">Carregando Sistema Financeiro...</p>
            </div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { 
            Home, TrendingUp, TrendingDown, CreditCard, PiggyBank, Target,
            BarChart3, FileText, Plus, Edit2, Trash2, Eye, EyeOff, 
            DollarSign, Wallet 
        } = lucide;

        const FinancialControlSystem = () => {
            // Estados principais
            const [activeTab, setActiveTab] = useState('dashboard');
            const [showValues, setShowValues] = useState(true);
            
            // Estados para dados financeiros (com localStorage)
            const [receitas, setReceitas] = useState(() => {
                const saved = localStorage.getItem('receitas');
                return saved ? JSON.parse(saved) : [
                    { id: 1, descricao: 'Salário', valor: 5000, data: '2024-06-01', categoria: 'Trabalho' },
                    { id: 2, descricao: 'Freelance', valor: 1500, data: '2024-06-05', categoria: 'Extra' }
                ];
            });
            
            const [despesas, setDespesas] = useState(() => {
                const saved = localStorage.getItem('despesas');
                return saved ? JSON.parse(saved) : [
                    { id: 1, descricao: 'Aluguel', valor: 1200, data: '2024-06-01', categoria: 'Moradia' },
                    { id: 2, descricao: 'Supermercado', valor: 400, data: '2024-06-03', categoria: 'Alimentação' },
                    { id: 3, descricao: 'Gasolina', valor: 200, data: '2024-06-05', categoria: 'Transporte' }
                ];
            });
            
            const [contasBancarias, setContasBancarias] = useState(() => {
                const saved = localStorage.getItem('contasBancarias');
                return saved ? JSON.parse(saved) : [
                    { id: 1, nome: 'Conta Corrente', banco: 'Banco do Brasil', saldo: 3500, tipo: 'Corrente' },
                    { id: 2, nome: 'Conta Poupança', banco: 'Itaú', saldo: 8000, tipo: 'Poupança' }
                ];
            });
            
            const [cartoesCredito, setCartoesCredito] = useState(() => {
                const saved = localStorage.getItem('cartoesCredito');
                return saved ? JSON.parse(saved) : [
                    { id: 1, nome: 'Cartão Principal', limite: 5000, usado: 1200, vencimento: '2024-06-15' },
                    { id: 2, nome: 'Cartão Extra', limite: 2000, usado: 800, vencimento: '2024-06-20' }
                ];
            });
            
            const [investimentos, setInvestimentos] = useState(() => {
                const saved = localStorage.getItem('investimentos');
                return saved ? JSON.parse(saved) : [
                    { id: 1, nome: 'Tesouro Direto', valor: 15000, rentabilidade: 12.5, tipo: 'Renda Fixa' },
                    { id: 2, nome: 'Ações', valor: 8000, rentabilidade: -2.3, tipo: 'Renda Variável' }
                ];
            });
            
            const [metas, setMetas] = useState(() => {
                const saved = localStorage.getItem('metas');
                return saved ? JSON.parse(saved) : [
                    { id: 1, nome: 'Viagem Europa', valorMeta: 20000, valorAtual: 8500, prazo: '2024-12-31' },
                    { id: 2, nome: 'Reserva Emergência', valorMeta: 30000, valorAtual: 15000, prazo: '2024-12-31' }
                ];
            });

            // Salvar no localStorage quando os dados mudarem
            useEffect(() => {
                localStorage.setItem('receitas', JSON.stringify(receitas));
            }, [receitas]);

            useEffect(() => {
                localStorage.setItem('despesas', JSON.stringify(despesas));
            }, [despesas]);

            useEffect(() => {
                localStorage.setItem('contasBancarias', JSON.stringify(contasBancarias));
            }, [contasBancarias]);

            useEffect(() => {
                localStorage.setItem('cartoesCredito', JSON.stringify(cartoesCredito));
            }, [cartoesCredito]);

            useEffect(() => {
                localStorage.setItem('investimentos', JSON.stringify(investimentos));
            }, [investimentos]);

            useEffect(() => {
                localStorage.setItem('metas', JSON.stringify(metas));
            }, [metas]);

            // Modals
            const [showModal, setShowModal] = useState(false);
            const [modalType, setModalType] = useState('');
            const [editingItem, setEditingItem] = useState(null);
            const [formData, setFormData] = useState({});

            // Cálculos
            const totalReceitas = receitas.reduce((sum, item) => sum + item.valor, 0);
            const totalDespesas = despesas.reduce((sum, item) => sum + item.valor, 0);
            const saldoTotal = contasBancarias.reduce((sum, conta) => sum + conta.saldo, 0);
            const totalInvestimentos = investimentos.reduce((sum, inv) => sum + inv.valor, 0);
            const saldoMensal = totalReceitas - totalDespesas;

            // Função para formatar moeda
            const formatCurrency = (value) => {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                }).format(value);
            };

            // Função para formatar data
            const formatDate = (dateString) => {
                return new Date(dateString).toLocaleDateString('pt-BR');
            };

            // Componente do Modal
            const Modal = ({ children, onClose }) => (
                React.createElement('div', {
                    className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",
                    onClick: (e) => e.target === e.currentTarget && onClose()
                },
                    React.createElement('div', {
                        className: "bg-white rounded-lg p-6 w-full max-w-md mx-4 fade-in"
                    },
                        React.createElement('div', {
                            className: "flex justify-between items-center mb-4"
                        },
                            React.createElement('h3', {
                                className: "text-lg font-semibold"
                            }, `${editingItem ? 'Editar' : 'Adicionar'} ${modalType}`),
                            React.createElement('button', {
                                onClick: onClose,
                                className: "text-gray-500 hover:text-gray-700"
                            }, React.createElement(Plus, { className: "w-5 h-5 rotate-45" }))
                        ),
                        children
                    )
                )
            );

            // Componente do Card
            const Card = ({ title, value, icon: Icon, color = "blue", trend = null }) => (
                React.createElement('div', {
                    className: `bg-white rounded-xl shadow-lg p-6 border-l-4 border-${color}-500 fade-in hover:shadow-xl transition-shadow`
                },
                    React.createElement('div', {
                        className: "flex items-center justify-between"
                    },
                        React.createElement('div', null,
                            React.createElement('p', {
                                className: "text-gray-600 text-sm font-medium"
                            }, title),
                            React.createElement('p', {
                                className: `text-2xl font-bold text-${color}-600 mt-1`
                            }, showValues ? value : '••••••'),
                            trend && React.createElement('p', {
                                className: `text-sm mt-1 ${trend > 0 ? 'text-green-600' : 'text-red-600'}`
                            }, `${trend > 0 ? '↗' : '↘'} ${Math.abs(trend)}%`)
                        ),
                        React.createElement('div', {
                            className: `bg-${color}-100 p-3 rounded-full`
                        }, React.createElement(Icon, { className: `w-6 h-6 text-${color}-600` }))
                    )
                )
            );

            // Dashboard
            const Dashboard = () => (
                React.createElement('div', { className: "space-y-6" },
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" },
                        React.createElement(Card, {
                            title: "Receitas Mensais",
                            value: formatCurrency(totalReceitas),
                            icon: TrendingUp,
                            color: "green",
                            trend: 8.5
                        }),
                        React.createElement(Card, {
                            title: "Despesas Mensais",
                            value: formatCurrency(totalDespesas),
                            icon: TrendingDown,
                            color: "red",
                            trend: -3.2
                        }),
                        React.createElement(Card, {
                            title: "Saldo Atual",
                            value: formatCurrency(saldoTotal),
                            icon: Wallet,
                            color: "blue"
                        }),
                        React.createElement(Card, {
                            title: "Investimentos",
                            value: formatCurrency(totalInvestimentos),
                            icon: PiggyBank,
                            color: "purple",
                            trend: 12.3
                        })
                    ),
                    
                    React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-6" },
                        React.createElement('div', { className: "bg-white rounded-xl shadow-lg p-6 fade-in" },
                            React.createElement('h3', { className: "text-lg font-semibold mb-4" }, "Resumo Mensal"),
                            React.createElement('div', { className: "space-y-3" },
                                React.createElement('div', { className: "flex justify-between" },
                                    React.createElement('span', { className: "text-gray-600" }, "Total Receitas:"),
                                    React.createElement('span', { className: "font-semibold text-green-600" }, formatCurrency(totalReceitas))
                                ),
                                React.createElement('div', { className: "flex justify-between" },
                                    React.createElement('span', { className: "text-gray-600" }, "Total Despesas:"),
                                    React.createElement('span', { className: "font-semibold text-red-600" }, formatCurrency(totalDespesas))
                                ),
                                React.createElement('hr'),
                                React.createElement('div', { className: "flex justify-between" },
                                    React.createElement('span', { className: "text-gray-600" }, "Saldo Mensal:"),
                                    React.createElement('span', {
                                        className: `font-bold ${saldoMensal >= 0 ? 'text-green-600' : 'text-red-600'}`
                                    }, formatCurrency(saldoMensal))
                                )
                            )
                        ),
                        
                        React.createElement('div', { className: "bg-white rounded-xl shadow-lg p-6 fade-in" },
                            React.createElement('h3', { className: "text-lg font-semibold mb-4" }, "Metas em Andamento"),
                            React.createElement('div', { className: "space-y-4" },
                                metas.slice(0, 2).map(meta => (
                                    React.createElement('div', { key: meta.id },
                                        React.createElement('div', { className: "flex justify-between mb-1" },
                                            React.createElement('span', { className: "text-sm font-medium text-gray-700" }, meta.nome),
                                            React.createElement('span', { className: "text-sm text-gray-500" }, 
                                                `${Math.round((meta.valorAtual / meta.valorMeta) * 100)}%`
                                            )
                                        ),
                                        React.createElement('div', { className: "w-full bg-gray-200 rounded-full h-2" },
                                            React.createElement('div', {
                                                className: "bg-blue-600 h-2 rounded-full transition-all duration-500",
                                                style: { width: `${(meta.valorAtual / meta.valorMeta) * 100}%` }
                                            })
                                        )
                                    )
                                ))
                            )
                        )
                    )
                )
            );

            // Função para lidar com formulários
            const handleSubmit = (e) => {
                e.preventDefault();
                
                const newId = Date.now();
                const newItem = { ...formData, id: editingItem ? editingItem.id : newId };
                
                switch (modalType) {
                    case 'Receita':
                        if (editingItem) {
                            setReceitas(receitas.map(item => item.id === editingItem.id ? newItem : item));
                        } else {
                            setReceitas([...receitas, newItem]);
                        }
                        break;
                    case 'Despesa':
                        if (editingItem) {
                            setDespesas(despesas.map(item => item.id === editingItem.id ? newItem : item));
                        } else {
                            setDespesas([...despesas, newItem]);
                        }
                        break;
                    case 'Conta Bancária':
                        if (editingItem) {
                            setContasBancarias(contasBancarias.map(item => item.id === editingItem.id ? newItem : item));
                        } else {
                            setContasBancarias([...contasBancarias, newItem]);
                        }
                        break;
                    case 'Cartão de Crédito':
                        if (editingItem) {
                            setCartoesCredito(cartoesCredito.map(item => item.id === editingItem.id ? newItem : item));
                        } else {
                            setCartoesCredito([...cartoesCredito, newItem]);
                        }
                        break;
                    case 'Investimento':
                        if (editingItem) {
                            setInvestimentos(investimentos.map(item => item.id === editingItem.id ? newItem : item));
                        } else {
                            setInvestimentos([...investimentos, newItem]);
                        }
                        break;
                    case 'Meta':
                        if (editingItem) {
                            setMetas(metas.map(item => item.id === editingItem.id ? newItem : item));
                        } else {
                            setMetas([...metas, newItem]);
                        }
                        break;
                }
                
                setShowModal(false);
                setFormData({});
                setEditingItem(null);
            };

            // Função para renderizar conteúdo baseado na aba ativa
            const renderContent = () => {
                switch (activeTab) {
                    case 'dashboard':
                        return React.createElement(Dashboard);
                    default:
                        return React.createElement(Dashboard);
                }
            };

            // Navegação
            const navigation = [
                { id: 'dashboard', name: 'Dashboard', icon: Home },
                { id: 'receitas', name: 'Receitas', icon: TrendingUp },
                { id: 'despesas', name: 'Despesas', icon: TrendingDown },
                { id: 'contas', name: 'Contas Bancárias', icon: Wallet },
                { id: 'cartoes', name: 'Cartões de Crédito', icon: CreditCard },
                { id: 'investimentos', name: 'Investimentos', icon: PiggyBank },
                { id: 'metas', name: 'Metas', icon: Target },
                { id: 'resumo', name: 'Resumo', icon: BarChart3 }
            ];

            return (
                React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100" },
                    // Header
                    React.createElement('header', { className: "bg-white shadow-lg border-b border-gray-200" },
                        React.createElement('div', { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" },
                            React.createElement('div', { className: "flex justify-between items-center h-16" },
                                React.createElement('div', { className: "flex items-center" },
                                    React.createElement(DollarSign, { className: "w-8 h-8 text-blue-600 mr-3" }),
                                    React.createElement('h1', { className: "text-xl font-bold text-gray-900" }, "Sistema Financeiro")
                                ),
                                
                                React.createElement('div', { className: "flex items-center space-x-4" },
                                    React.createElement('button', {
                                        onClick: () => setShowValues(!showValues),
                                        className: "flex items-center space-x-2 px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors"
                                    },
                                        showValues ? 
                                            React.createElement(Eye, { className: "w-4 h-4 text-gray-600" }) :
                                            React.createElement(EyeOff, { className: "w-4 h-4 text-gray-600" }),
                                        React.createElement('span', { className: "text-sm text-gray-600" },
                                            showValues ? 'Ocultar' : 'Mostrar', ' valores'
                                        )
                                    ),
                                    
                                    React.createElement('div', { className: "text-right" },
                                        React.createElement('p', { className: "text-sm text-gray-600" }, "Patrimônio Total"),
                                        React.createElement('p', { className: "text-lg font-bold text-green-600" },
                                            showValues ? formatCurrency(saldoTotal + totalInvestimentos) : '••••••'
                                        )
                                    )
                                )
                            )
                        )
                    ),

                    React.createElement('div', { className: "flex" },
                        // Sidebar
                        React.createElement('nav', { className: "w-64 bg-white shadow-lg min-h-screen" },
                            React.createElement('div', { className: "p-4" },
                                React.createElement('ul', { className: "space-y-2" },
                                    navigation.map((item) => {
                                        const Icon = item.icon;
                                        return React.createElement('li', { key: item.id },
                                            React.createElement('button', {
                                                onClick: () => setActiveTab(item.id),
                                                className: `w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${
                                                    activeTab === item.id
                                                        ? 'bg-blue-600 text-white'
                                                        : 'text-gray-700 hover:bg-gray-100'
                                                }`
                                            },
                                                React.createElement(Icon, { className: "w-5 h-5" }),
                                                React.createElement('span', { className: "font-medium" }, item.name)
                                            )
                                        );
                                    })
                                )
                            )
                        ),

                        // Main Content
                        React.createElement('main', { className: "flex-1 p-8" },
                            renderContent()
                        )
                    ),

                    // Modal
                    showModal && React.createElement(Modal, {
                        onClose: () => setShowModal(false)
                    }, "Formulário em construção...")
                )
            );
        };

        // Renderizar o componente
        const domContainer = document.querySelector('#root');
        const root = ReactDOM.createRoot(domContainer);
        root.render(React.createElement(FinancialControlSystem));
    </script>
</body>
</html>